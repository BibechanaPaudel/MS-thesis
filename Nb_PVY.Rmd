---
title: "Nb_PVY"
author: "Bibechana Paudel"
date: "2025-10-29"
output: html_document
---

# **First trial**

###Libraries used

```{r}
#install.packages("tidyverse")
#install.packages("ggplot2")
#install.packages("agricolae")
#install.packages("tidyr")
#install.packages("ggpubr")
#install.packages("multcomp")
#install.packages("emmeans")
#install.packages("multcompView")
library(tidyverse)
library(ggplot2)
library(agricolae)
library(tidyr)
library(ggpubr)
library(multcomp)
library(emmeans)
library(multcompView)
```

###Load and verify data of Rep 1
```{r}
rep1 <- read.csv("Data-obj1-New/Nb_PVY_1st_trial_New.csv", header=T)
head(rep1)  # View the first few rows
str(rep1)   # Check the structure of the data
summary(rep1) # Quick statistical summary
```

###Make the factor variable
```{r}
rep1$Dpi<-as.factor(rep1$Dpi)
```

##Calculate the ViralLoad using the regression equation derived by (Feng , J.L et al., 2006 ) and log transform for normality.

[Feng, J.L et al., 2006](https://academic.oup.com/abbs/article/38/10/669/217)

```{r}
rep1<-rep1 %>% 
mutate (ViralLoad=((10^((Cq-49.153)/-3.93)))) %>% ##added a new column and named ViralLoad
mutate(logViralLoad=log10(ViralLoad))  ##added a new column and named logViralLoad
```

##Classify the sample collection days based on leaf

```{r}
rep1$Leaf_sample<- ifelse(
  grepl("^IL", rep1$Dpi), "Inoculated",  # Matches Dpi values starting with IL
  ifelse(grepl("^SL", rep1$Dpi), "Systemic", NA)
)
```

##Data summarization

```{r}
PVY1 <- rep1 %>%  # Start with the dataset `rep1` and pipe (%>%) it into the next operations
  group_by(Dpi, Leaf_sample) %>%   # Group the data by treatment type and days post-inoculation (Dpi)
  dplyr::summarize(
    avg.virus= mean(logViralLoad, na.rm=TRUE),
    n=n(),
    se = sd(logViralLoad)/sqrt(n)) # join the significant letters with the PVY1 data frame.
```



```{r PVY 1st trial_NB_PVY3_10ng }
PVY_1 <- ggplot(PVY1,aes(x =factor(Dpi,levels=c("IL-1", "IL-4", "IL-7", "IL-10","SL-7", "SL-10")), y = avg.virus)) +
  stat_summary(fun=mean,geom="bar", position = position_dodge(width = 0.3), width = 0.4, fill="#56B4E9") +
   geom_errorbar(aes(ymin = avg.virus - se, 
                    ymax = avg.virus + se),
                width = 0.3,
                position = position_dodge(width = 0.3)) +
  labs(x = "Time Point (Dpi)", y = "Log Copy Number") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5),
        strip.text = element_text(face = "bold", size = 12, color = "black"),
        legend.position = "none", 
        axis.text.x = element_text(color = "black", face="bold", size=12),   # X-axis text color
        axis.text.y = element_text(color = "black", face="bold", size=12),   # Y-axis text color
        axis.title.x = element_text(color = "black", face="bold", size=15),  # X-axis label color
        axis.title.y = element_text(color = "black", face="bold", size=15),  # Y-axis label color
        axis.line = element_line(color = "black", size=0.75)      # Axis lines color
  ) +
  scale_y_continuous(
    expand = expansion(mult = c(0, 0.02)), breaks = seq(1, 9, by = 1)  # This removes padding at the bottom of the plot
  )+
   scale_x_discrete(drop = TRUE) +
  facet_grid(~Leaf_sample, scale="free_x", space="free_x")# Sets y-axis limits but removes points outside 0-8

PVY_1

```

## Second trial
###Load and verify data of Rep 2
```{r}
rep2 <- read.csv("Data-obj1-New/Nb_PVY_2nd_trial_New.csv", header=T)
head(rep2)  # View the first few rows
str(rep2)   # Check the structure of the data
summary(rep2) # Quick statistical summary
```

###Make the factor variable
```{r}
rep2$Dpi<-as.factor(rep2$Dpi)
```

##Calculate the ViralLoad using the regression equation derived by (Feng , J.L et al., 2006 ) and log transform for normality.

[Feng, J.L et al., 2006](https://academic.oup.com/abbs/article/38/10/669/217)

```{r}
rep2<-rep2 %>% 
mutate (ViralLoad=((10^((Cq-49.153)/-3.93)))) %>%##added a new column and named ViralLoad
mutate(logViralLoad=log10(ViralLoad)) %>% 
  filter(rep2$Dpi!="SL-14")##added a new column and named logViralLoad
```

##Classify the sample collection days based on leaf

```{r}
rep2$Leaf_sample<- ifelse(
  grepl("^IL", rep2$Dpi), "Inoculated",  # Matches Dpi values starting with IL
  ifelse(grepl("^SL", rep2$Dpi), "Systemic", NA)
)
```

##Data summarization

```{r}
PVY2 <- rep2 %>%  # Start with the dataset `rep2` and pipe (%>%) it into the next operations
  group_by(Dpi, Leaf_sample) %>%   # Group the data by treatment type and days post-inoculation (Dpi)
  dplyr::summarize(
    avg.virus= mean(logViralLoad, na.rm=TRUE),
    n=n(),
    se = sd(logViralLoad)/sqrt(n)) # join the significant letters with the PVY1 data frame.
```



```{r PVY 2nd trial_NB_PVY3_10ng }
PVY_2 <- ggplot(PVY2,aes(x =factor(Dpi,levels=c("IL-1", "IL-4", "IL-7", "IL-10","SL-7", "SL-10")), y = avg.virus)) +
  stat_summary(fun=mean,geom="bar", position = position_dodge(width = 0.3), width = 0.4, fill="#56B4E9") +
   geom_errorbar(aes(ymin = avg.virus - se, 
                    ymax = avg.virus + se),
                width = 0.3,
                position = position_dodge(width = 0.3)) +
  labs(x = "Time Point (Dpi)", y = "Log Copy Number") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5),
        strip.text = element_text(face = "bold", size = 12, color = "black"),
        legend.position = "none", 
        axis.text.x = element_text(color = "black", face="bold", size=12),   # X-axis text color
        axis.text.y = element_text(color = "black", face="bold", size=12),   # Y-axis text color
        axis.title.x = element_text(color = "black", face="bold", size=15),  # X-axis label color
        axis.title.y = element_text(color = "black", face="bold", size=15),  # Y-axis label color
        axis.line = element_line(color = "black", size=0.75)      # Axis lines color
  ) +
  scale_y_continuous(
    expand = expansion(mult = c(0, 0.02)), breaks = seq(1, 9, by = 1)  # This removes padding at the bottom of the plot
  )+
   scale_x_discrete(drop = TRUE) +
  facet_grid(~Leaf_sample, scale="free_x", space="free_x")# Sets y-axis limits but removes points outside 0-8

PVY_2

```


###Load and verify data of Rep 1
```{r}
rep1_PVY3_1ng <- read.csv("Data-obj1-New/Nb_PVY_1st_PVY3_1ng.csv", header=T)
head(rep1_PVY3_1ng)  # View the first few rows
str(rep1_PVY3_1ng)   # Check the structure of the data
summary(rep1_PVY3_1ng) # Quick statistical summary
```

###Make the factor variable
```{r}
rep1_PVY3_1ng$Dpi<-as.factor(rep1_PVY3_1ng$Dpi)
```

##Calculate the ViralLoad using the regression equation derived by (Feng , J.L et al., 2006 ) and log transform for normality.

[Feng, J.L et al., 2006](https://academic.oup.com/abbs/article/38/10/669/217)

```{r}
rep1_PVY3_1ng<-rep1_PVY3_1ng %>% 
mutate (ViralLoad=((10^((Cq-49.153)/-3.93)))) %>% ##added a new column and named ViralLoad
mutate(logViralLoad=log10(ViralLoad))  ##added a new column and named logViralLoad
```

##Classify the sample collection days based on leaf

```{r}
rep1_PVY3_1ng$Leaf_sample<- ifelse(
  grepl("^IL", rep1_PVY3_1ng$Dpi), "Inoculated",  # Matches Dpi values starting with IL
  ifelse(grepl("^SL", rep1_PVY3_1ng$Dpi), "Systemic", NA)
)
```

##Data summarization

```{r}
PVY1 <- rep1_PVY3_1ng %>%  # Start with the dataset `rep1` and pipe (%>%) it into the next operations
  group_by(Dpi, Leaf_sample) %>%   # Group the data by treatment type and days post-inoculation (Dpi)
  dplyr::summarize(
    avg.virus= mean(logViralLoad, na.rm=TRUE),
    n=n(),
    se = sd(logViralLoad)/sqrt(n)) # join the significant letters with the PVY1 data frame.
```



```{r PVY 1st trial_NB_PVY3_1ng }
PVY_1_PVY3_1ng <- ggplot(PVY1,aes(x =factor(Dpi,levels=c("IL-1", "IL-4", "IL-7", "IL-10","SL-7", "SL-10")), y = avg.virus)) +
  stat_summary(fun=mean,geom="bar", position = position_dodge(width = 0.3), width = 0.4, fill="#56B4E9") +
   geom_errorbar(aes(ymin = avg.virus - se, 
                    ymax = avg.virus + se),
                width = 0.3,
                position = position_dodge(width = 0.3)) +
  labs(x = "Time Point (Dpi)", y = "Log Copy Number") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5),
        strip.text = element_text(face = "bold", size = 12, color = "black"),
        legend.position = "none", 
        axis.text.x = element_text(color = "black", face="bold", size=12),   # X-axis text color
        axis.text.y = element_text(color = "black", face="bold", size=12),   # Y-axis text color
        axis.title.x = element_text(color = "black", face="bold", size=15),  # X-axis label color
        axis.title.y = element_text(color = "black", face="bold", size=15),  # Y-axis label color
        axis.line = element_line(color = "black", size=0.75)      # Axis lines color
  ) +
  scale_y_continuous(
    expand = expansion(mult = c(0, 0.02)), breaks = seq(1, 9, by = 1)  # This removes padding at the bottom of the plot
  )+
   scale_x_discrete(drop = TRUE) +
  facet_grid(~Leaf_sample, scale="free_x", space="free_x")# Sets y-axis limits but removes points outside 0-8


PVY_1_PVY3_1ng

```



```{r}
PVY_1 <- PVY_1 +
  labs(x = NULL, y = NULL) +
  theme(axis.title = element_blank())
PVY_1_PVY3_1ng<-PVY_1_PVY3_1ng+
  labs(x = NULL, y = NULL) +
  theme(axis.title = element_blank())

PVY_2 <- PVY_2 +
  labs(x = NULL, y = NULL) +
  theme(axis.title = element_blank())
combined_plot_PVY3 <- ggarrange(
  PVY_1,
  PVY_1_PVY3_1ng,
  PVY_2,
  ncol = 1,
  labels = c("A", "B"),
  align = "v"      # vertically align plots
)

# Add shared axis titles
combined_plot_PVY3_annotated <- annotate_figure(
  combined_plot_PVY3,
  bottom = text_grob("Time Point (Dpi)", size = 15, face="bold"),
  left = text_grob("Log Copy Number", rot = 90, size = 15, face="bold")
)
combined_plot_PVY3_annotated
```



# **Supplementary First trial**

###Libraries used

```{r}
#install.packages("tidyverse")
#install.packages("ggplot2")
#install.packages("agricolae")
#install.packages("tidyr")
#install.packages("ggpubr")
#install.packages("multcomp")
#install.packages("emmeans")
#install.packages("multcompView")
library(tidyverse)
library(ggplot2)
library(agricolae)
library(tidyr)
library(ggpubr)
library(multcomp)
library(emmeans)
library(multcompView)
```

###Load and verify data of Rep 1
```{r}
rep1_PVY1_10ng <- read.csv("Data-obj1-New/Nb_PVY_1st_PVY1_10ng.csv", header=T)
head(rep1_PVY1_10ng)  # View the first few rows
str(rep1_PVY1_10ng)   # Check the structure of the data
summary(rep1_PVY1_10ng) # Quick statistical summary
```

###Make the factor variable
```{r}
rep1_PVY1_10ng$Dpi<-as.factor(rep1_PVY1_10ng$Dpi)
```

##Calculate the ViralLoad using the regression equation derived by (Feng , J.L et al., 2006 ) and log transform for normality.

[Feng, J.L et al., 2006](https://academic.oup.com/abbs/article/38/10/669/217)

```{r}
rep1_PVY1_10ng<-rep1_PVY1_10ng %>% 
mutate (ViralLoad=((10^((Cq-49.153)/-3.93)))) %>% ##added a new column and named ViralLoad
mutate(logViralLoad=log10(ViralLoad))  ##added a new column and named logViralLoad
```

##Classify the sample collection days based on leaf

```{r}
rep1_PVY1_10ng$Leaf_sample<- ifelse(
  grepl("^IL", rep1_PVY1_10ng$Dpi), "Inoculated",  # Matches Dpi values starting with IL
  ifelse(grepl("^SL", rep1_PVY1_10ng$Dpi), "Systemic", NA)
)
```

##Data summarization

```{r}
PVY1 <- rep1_PVY1_10ng %>%  # Start with the dataset `rep1` and pipe (%>%) it into the next operations
  group_by(Dpi, Leaf_sample) %>%   # Group the data by treatment type and days post-inoculation (Dpi)
  dplyr::summarize(
    avg.virus= mean(logViralLoad, na.rm=TRUE),
    n=n(),
    se = sd(logViralLoad)/sqrt(n)) # join the significant letters with the PVY1 data frame.
```



```{r PVY 1st trial_NB_PVY1_10ng }
PVY_1_PVY1_10ng <- ggplot(PVY1,aes(x =factor(Dpi,levels=c("IL-1", "IL-4", "IL-7", "IL-10","SL-7", "SL-10")), y = avg.virus)) +
  stat_summary(fun=mean,geom="bar", position = position_dodge(width = 0.3), width = 0.4, fill="#56B4E9") +
   geom_errorbar(aes(ymin = avg.virus - se, 
                    ymax = avg.virus + se),
                width = 0.3,
                position = position_dodge(width = 0.3)) +
  labs(x = "Time Point (Dpi)", y = "Log Copy Number") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5),
        strip.text = element_text(face = "bold", size = 12, color = "black"),
        legend.position = "none", 
        axis.text.x = element_text(color = "black", face="bold", size=12),   # X-axis text color
        axis.text.y = element_text(color = "black", face="bold", size=12),   # Y-axis text color
        axis.title.x = element_text(color = "black", face="bold", size=15),  # X-axis label color
        axis.title.y = element_text(color = "black", face="bold", size=15),  # Y-axis label color
        axis.line = element_line(color = "black", size=0.75)      # Axis lines color
  ) +
  scale_y_continuous(
    expand = expansion(mult = c(0, 0.02)), breaks = seq(1, 9, by = 1)  # This removes padding at the bottom of the plot
  )+
   scale_x_discrete(drop = TRUE) +
  facet_grid(~Leaf_sample, scale="free_x", space="free_x")# Sets y-axis limits but removes points outside 0-8

PVY_1_PVY1_10ng

```


###Load and verify data of Rep 1
```{r}
rep1_PVY1_1ng <- read.csv("Data-obj1-New/Nb_PVY_1st_PVY1_1ng.csv", header=T)
head(rep1_PVY1_1ng)  # View the first few rows
str(rep1_PVY1_1ng)   # Check the structure of the data
summary(rep1_PVY1_1ng) # Quick statistical summary
```

###Make the factor variable
```{r}
rep1_PVY1_1ng$Dpi<-as.factor(rep1_PVY1_1ng$Dpi)
```

##Calculate the ViralLoad using the regression equation derived by (Feng , J.L et al., 2006 ) and log transform for normality.

[Feng, J.L et al., 2006](https://academic.oup.com/abbs/article/38/10/669/217)

```{r}
rep1_PVY1_1ng<-rep1_PVY1_1ng %>% 
mutate (ViralLoad=((10^((Cq-49.153)/-3.93)))) %>% ##added a new column and named ViralLoad
mutate(logViralLoad=log10(ViralLoad))  ##added a new column and named logViralLoad
```

##Classify the sample collection days based on leaf

```{r}
rep1_PVY1_1ng$Leaf_sample<- ifelse(
  grepl("^IL", rep1_PVY1_1ng$Dpi), "Inoculated",  # Matches Dpi values starting with IL
  ifelse(grepl("^SL", rep1_PVY1_1ng$Dpi), "Systemic", NA)
)
```

##Data summarization

```{r}
PVY1 <- rep1_PVY1_1ng %>%  # Start with the dataset `rep1` and pipe (%>%) it into the next operations
  group_by(Dpi, Leaf_sample) %>%   # Group the data by treatment type and days post-inoculation (Dpi)
  dplyr::summarize(
    avg.virus= mean(logViralLoad, na.rm=TRUE),
    n=n(),
    se = sd(logViralLoad)/sqrt(n)) # join the significant letters with the PVY1 data frame.
```



```{r PVY 1st trial_NB_PVY1_1ng }
PVY_1_PVY1_1ng <- ggplot(PVY1,aes(x =factor(Dpi,levels=c("IL-1", "IL-4", "IL-7", "IL-10","SL-7", "SL-10")), y = avg.virus)) +
  stat_summary(fun=mean,geom="bar", position = position_dodge(width = 0.3), width = 0.4, fill="#56B4E9") +
   geom_errorbar(aes(ymin = avg.virus - se, 
                    ymax = avg.virus + se),
                width = 0.3,
                position = position_dodge(width = 0.3)) +
  labs(x = "Time Point (Dpi)", y = "Log Copy Number") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5),
        strip.text = element_text(face = "bold", size = 12, color = "black"),
        legend.position = "none", 
        axis.text.x = element_text(color = "black", face="bold", size=12),   # X-axis text color
        axis.text.y = element_text(color = "black", face="bold", size=12),   # Y-axis text color
        axis.title.x = element_text(color = "black", face="bold", size=15),  # X-axis label color
        axis.title.y = element_text(color = "black", face="bold", size=15),  # Y-axis label color
        axis.line = element_line(color = "black", size=0.75)      # Axis lines color
  ) +
  scale_y_continuous(
    expand = expansion(mult = c(0, 0.02)), breaks = seq(1, 9, by = 1)  # This removes padding at the bottom of the plot
  )+
   scale_x_discrete(drop = TRUE) +
  facet_grid(~Leaf_sample, scale="free_x", space="free_x")# Sets y-axis limits but removes points outside 0-8
PVY_1_PVY1_1ng

```







## Second trial
###Load and verify data of Rep 2
```{r}
rep2_PVY1_10ng <-read.csv("Data-obj1-New/Nb_PVY_2nd_PVY1_10ng.csv", header=T)
head(rep2_PVY1_10ng)  # View the first few rows
str(rep2_PVY1_10ng)   # Check the structure of the data
summary(rep2_PVY1_10ng) # Quick statistical summary
```

###Make the factor variable
```{r}
rep2_PVY1_10ng$Dpi<-as.factor(rep2_PVY1_10ng$Dpi)
```

##Calculate the ViralLoad using the regression equation derived by (Feng , J.L et al., 2006 ) and log transform for normality.

[Feng, J.L et al., 2006](https://academic.oup.com/abbs/article/38/10/669/217)

```{r}
rep2_PVY1_10ng<-rep2_PVY1_10ng %>% 
mutate (ViralLoad=((10^((Cq-49.153)/-3.93)))) %>% ##added a new column and named ViralLoad
mutate(logViralLoad=log10(ViralLoad)) %>% 
  filter(Dpi!="SL-14")##added a new column and named logViralLoad
```

##Classify the sample collection days based on leaf

```{r}
rep2_PVY1_10ng$Leaf_sample<- ifelse(
  grepl("^IL", rep2_PVY1_10ng$Dpi), "Inoculated",  # Matches Dpi values starting with IL
  ifelse(grepl("^SL", rep2_PVY1_10ng$Dpi), "Systemic", NA)
)
```

##Data summarization

```{r}
PVY2 <- rep2_PVY1_10ng %>%  # Start with the dataset `rep2_PVY1_10ng` and pipe (%>%) it into the next operations
  group_by(Dpi, Leaf_sample) %>%   # Group the data by treatment type and days post-inoculation (Dpi)
  dplyr::summarize(
    avg.virus= mean(logViralLoad, na.rm=TRUE),
    n=n(),
    se = sd(logViralLoad)/sqrt(n)) # join the significant letters with the PVY1 data frame.
```



```{r PVY 2nd trial_NB_PVY1_10ng}
PVY_2_PVY1_10ng <- ggplot(PVY2,aes(x =factor(Dpi,levels=c("IL-1", "IL-4", "IL-7", "IL-10","SL-7", "SL-10")), y = avg.virus)) +
  stat_summary(fun=mean,geom="bar", position = position_dodge(width = 0.3), width = 0.4, fill="#56B4E9") +
   geom_errorbar(aes(ymin = avg.virus - se, 
                    ymax = avg.virus + se),
                width = 0.3,
                position = position_dodge(width = 0.3)) +
  labs(x = "Time Point (Dpi)", y = "Log Copy Number") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5),
        strip.text = element_text(face = "bold", size = 12, color = "black"),
        legend.position = "none", 
        axis.text.x = element_text(color = "black", face="bold", size=12),   # X-axis text color
        axis.text.y = element_text(color = "black", face="bold", size=12),   # Y-axis text color
        axis.title.x = element_text(color = "black", face="bold", size=15),  # X-axis label color
        axis.title.y = element_text(color = "black", face="bold", size=15),  # Y-axis label color
        axis.line = element_line(color = "black", size=0.75)      # Axis lines color
  ) +
  scale_y_continuous(
    expand = expansion(mult = c(0, 0.02)), breaks = seq(1, 9, by = 1)  # This removes padding at the bottom of the plot
  )+
   scale_x_discrete(drop = TRUE) +
  facet_grid(~Leaf_sample, scale="free_x", space="free_x")# Sets y-axis limits but removes points outside 0-8

PVY_2_PVY1_10ng

```

```{r}
PVY_1_PVY1_10ng <- PVY_1_PVY1_10ng +
  labs(x = NULL, y = NULL) +
  theme(axis.title = element_blank())
PVY_1_PVY1_1ng<-PVY_1_PVY1_1ng+
  labs(x = NULL, y = NULL) +
  theme(axis.title = element_blank())

PVY_2_PVY1_10ng <- PVY_2_PVY1_10ng +
  labs(x = NULL, y = NULL) +
  theme(axis.title = element_blank())
combined_plot_PVY1 <- ggarrange(
  PVY_1_PVY1_10ng,
  PVY_1_PVY1_1ng,
  PVY_2_PVY1_10ng,
  ncol = 1,
  labels = c("A", "B"),
  align = "v"      # vertically align plots
)

# Add shared axis titles
combined_plot_PVY1_annotated <- annotate_figure(
  combined_plot_PVY1,
  bottom = text_grob("Time Point (Dpi)", size = 15, face="bold"),
  left = text_grob("Log Copy Number", rot = 90, size = 15, face="bold")
)
combined_plot_PVY1_annotated
```

